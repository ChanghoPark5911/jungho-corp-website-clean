rules_version = '2';

// Firebase Storage 보안 규칙
service firebase.storage {
  match /b/{bucket}/o {
    
    // 모든 사용자가 읽기 가능 (공개 이미지)
    match /{allPaths=**} {
      allow read: if true;
    }
    
    // 인증된 사용자만 쓰기 가능 (개발 단계에서는 모든 사용자 허용)
    // 프로덕션 환경에서는 아래 주석을 해제하고 인증 로직 추가
    
    // 프로젝트 이미지
    match /projects/{imageId} {
      allow write: if true; // 개발 중: 모든 쓰기 허용
      // allow write: if request.auth != null; // 프로덕션: 인증된 사용자만
      
      // 파일 크기 제한 (10MB)
      allow write: if request.resource.size < 10 * 1024 * 1024;
      
      // 이미지 파일만 허용
      allow write: if request.resource.contentType.matches('image/.*');
    }
    
    // 계열사 로고
    match /subsidiaries/{imageId} {
      allow write: if true;
      allow write: if request.resource.size < 10 * 1024 * 1024;
      allow write: if request.resource.contentType.matches('image/.*');
    }
    
    // 팀원 사진
    match /team/{imageId} {
      allow write: if true;
      allow write: if request.resource.size < 10 * 1024 * 1024;
      allow write: if request.resource.contentType.matches('image/.*');
    }
    
    // 제품 이미지
    match /products/{imageId} {
      allow write: if true;
      allow write: if request.resource.size < 10 * 1024 * 1024;
      allow write: if request.resource.contentType.matches('image/.*');
    }
    
    // 배너 이미지
    match /banners/{imageId} {
      allow write: if true;
      allow write: if request.resource.size < 10 * 1024 * 1024;
      allow write: if request.resource.contentType.matches('image/.*');
    }
    
    // 일반 이미지
    match /images/{imageId} {
      allow write: if true;
      allow write: if request.resource.size < 10 * 1024 * 1024;
      allow write: if request.resource.contentType.matches('image/.*');
    }
    
    // 이미지 삭제 (인증된 사용자만)
    match /{category}/{imageId} {
      allow delete: if true; // 개발 중: 모든 삭제 허용
      // allow delete: if request.auth != null; // 프로덕션: 인증된 사용자만
    }
  }
}

